<div class="container">
  <header class="header">
    <h1>TaskFlow Lite</h1>
    <p class="subtitle">A lightweight Rails task manager</p>
  </header>

  <% if notice %>
    <div class="notice"><%= notice %></div>
  <% end %>
  <% if alert %>
    <div class="alert"><%= alert %></div>
  <% end %>

  <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between mb-6">
    <%= link_to "New Task", new_task_path, class: "btn btn-primary w-full sm:w-auto" %>
    
    <div class="flex flex-wrap gap-2">
      <%= link_to "All", tasks_path, class: "text-sm px-3 py-1.5 rounded border transition-all #{'bg-blue-600 text-white border-blue-600' if @current_priority.blank?} #{'bg-white text-gray-600 border-gray-300 hover:text-blue-600 hover:border-blue-600' unless @current_priority.blank?}" %>
      <%= link_to "Low", tasks_path(priority: 'low'), class: "text-sm px-3 py-1.5 rounded border transition-all #{'bg-blue-600 text-white border-blue-600' if @current_priority == 'low'} #{'bg-white text-gray-600 border-gray-300 hover:text-blue-600 hover:border-blue-600' unless @current_priority == 'low'}" %>
      <%= link_to "Normal", tasks_path(priority: 'normal'), class: "text-sm px-3 py-1.5 rounded border transition-all #{'bg-blue-600 text-white border-blue-600' if @current_priority == 'normal'} #{'bg-white text-gray-600 border-gray-300 hover:text-blue-600 hover:border-blue-600' unless @current_priority == 'normal'}" %>
      <%= link_to "High", tasks_path(priority: 'high'), class: "text-sm px-3 py-1.5 rounded border transition-all #{'bg-blue-600 text-white border-blue-600' if @current_priority == 'high'} #{'bg-white text-gray-600 border-gray-300 hover:text-blue-600 hover:border-blue-600' unless @current_priority == 'high'}" %>
    </div>
  </div>

  <section class="tasks-section">
    <h2>Open Tasks (<%= @open_tasks.count %>)</h2>
    
    <% if @open_tasks.any? %>
      <div class="task-list">
        <% @open_tasks.each do |task| %>
          <div class="task-card p-4 sm:p-6">
            <div class="task-content space-y-2 sm:space-y-3">
              <div class="task-header">
                <h3 class="task-title text-lg sm:text-xl"><%= task.title %></h3>
                <span class="priority-badge priority-<%= task.priority %>"><%= task.priority.titleize %></span>
              </div>
              <% if task.description.present? %>
                <p class="task-description"><%= simple_format(task.description) %></p>
              <% end %>
              <p class="task-meta">Created <%= time_ago_in_words(task.created_at) %> ago</p>
            </div>
            <div class="flex gap-2 mt-4">
              <%= button_to "Complete", complete_task_path(task), method: :patch, class: "btn btn-success btn-sm flex-1 text-sm py-2" %>
              <%= link_to "Edit", edit_task_path(task), class: "btn btn-secondary btn-sm text-sm py-2" %>
              <%= button_to "Delete", task_path(task), method: :delete, 
                  data: { turbo_confirm: "Delete this task? This cannot be undone." }, class: "btn btn-danger btn-sm text-sm py-2" %>
            </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <p class="empty-state">No open tasks. Create one to get started!</p>
    <% end %>
  </section>

  <section class="tasks-section">
    <h2>Completed Tasks (<%= @completed_tasks.count %>)</h2>
    
    <% if @completed_tasks.any? %>
      <div class="task-list">
        <% @completed_tasks.each do |task| %>
          <div class="task-card task--completed p-4 sm:p-6">
            <div class="task-content space-y-2 sm:space-y-3">
              <div class="task-header">
                <h3 class="task-title text-lg sm:text-xl"><%= task.title %></h3>
                <span class="priority-badge priority-<%= task.priority %>"><%= task.priority.titleize %></span>
              </div>
              <% if task.description.present? %>
                <p class="task-description"><%= simple_format(task.description) %></p>
              <% end %>
              <p class="task-meta">
                Completed <%= time_ago_in_words(task.completed_at) %> ago
              </p>
            </div>
            <div class="flex gap-2 mt-4">
              <%= button_to "Reopen", reopen_task_path(task), method: :patch, class: "btn btn-secondary btn-sm flex-1 text-sm py-2" %>
              <%= button_to "Delete", task_path(task), method: :delete, 
                  data: { turbo_confirm: "Delete this task? This cannot be undone." }, class: "btn btn-danger btn-sm text-sm py-2" %>
            </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <p class="empty-state">No completed tasks yet.</p>
    <% end %>
  </section>
</div>
